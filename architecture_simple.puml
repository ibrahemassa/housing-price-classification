@startuml MLOps Architecture - Simplified

!theme plain
skinparam componentStyle rectangle
skinparam linetype ortho

title MLOps Pipeline Architecture (Simplified)

actor User

cloud "Docker Network" {
    component [Prefect Server\n:4200] as Prefect
    component [MLflow Server\n:5000] as MLflow
    component [Training Container] as Train
    component [Monitoring Container] as Monitor
    component [API Container\n:8081] as API
    component [Dashboard Container\n:8501] as Dashboard
}

database "Data Storage" {
    component [Data Directory\n(raw/processed/production/reference)] as Data
    component [Models Directory] as Models
    component [MLflow DB\n+ Artifacts] as MLflowDB
    component [Prefect DB] as PrefectDB
}

' User connections
User --> API : POST /predict
User --> Dashboard : View metrics
User --> MLflow : Model registry
User --> Prefect : Workflow UI

' Orchestration
Prefect --> Train : Orchestrate training
Prefect --> Monitor : Orchestrate monitoring

' Training flow
Train --> Data : Read/Write
Train --> MLflow : Log experiments
Train --> Models : Save models
Train --> MLflow : Register model

' Monitoring flow
Monitor --> Data : Read reference & production
Monitor --> MLflow : Log drift metrics
Monitor ..> Train : Trigger retraining\n(if drift detected)

' API flow
API --> MLflow : Load model
API --> Models : Load model file
API --> Data : Log inputs/predictions

' Dashboard flow
Dashboard --> Data : Read monitoring data
Dashboard --> MLflow : Fetch metrics

' Storage connections
MLflow --> MLflowDB
Prefect --> PrefectDB

@enduml

